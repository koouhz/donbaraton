import{c as Q,r as d,s as l,j as e,P as q,X as C,i as Ue,C as Ne}from"./index-hR7h3xft.js";import{n as i,F as De,L as z}from"./index-BTmhdvE4.js";import{P as T}from"./plus-5-QD-99n.js";import{S as Te}from"./search-BOrDwhaZ.js";import{S as J}from"./square-pen-23WKRUQ4.js";import{T as K}from"./trash-2-C990xH84.js";import{R as pe}from"./refresh-cw-SHhOlYLT.js";import{C as ue}from"./check-CnYAeNmq.js";import{S as xe}from"./scale-D2UcqUxz.js";import{C as Ge}from"./camera-C2WEWWEM.js";import{U as Le}from"./upload-9HCD4CAy.js";import{S as Oe}from"./save-CVL2Myj-.js";import{T as $e}from"./trending-up-BgkhDZTu.js";import{T as He}from"./triangle-alert-B_IWcPwx.js";const Ve=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],qe=Q("image",Ve);const Je=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ke=Q("sparkles",Je);const Qe=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],me=Q("tag",Qe);function pr(){const[g,X]=d.useState([]),[Y,fe]=d.useState([]),[ge,he]=d.useState([]),[G,B]=d.useState([]),[L,R]=d.useState([]),[O,Z]=d.useState(!0),[$,I]=d.useState(!1),[ee,re]=d.useState(!1),[H,h]=d.useState(null),[b,oe]=d.useState(""),[m,be]=d.useState(""),[_e,_]=d.useState(!1),[x,V]=d.useState(null),[ye,w]=d.useState(!1),[je,S]=d.useState(!1),[f,v]=d.useState({nombre:"",descripcion:""}),[u,y]=d.useState({nombre:"",abreviatura:""}),[te,E]=d.useState(!1),[ae,A]=d.useState(!1),[t,c]=d.useState({codigo_interno:"",codigo_barras:"",nombre:"",categoria_id:"",id_marca:"",id_unidad:"",proveedor_id:"",precio_costo:"",precio_venta:"",stock_minimo:10,stock_maximo:100,presentacion:"",controla_vencimiento:!1,foto_url:"",fotoFile:null}),p=()=>{const r=localStorage.getItem("user");if(r)try{return JSON.parse(r).usuario_id||"USR-001"}catch{return"USR-001"}return"USR-001"},ve=async()=>{if(!f.nombre.trim()){i.error("El nombre de la marca es obligatorio");return}E(!0);try{const{data:r,error:a}=await l.rpc("fn_crear_marca",{p_nombre:f.nombre.trim(),p_descripcion:f.descripcion.trim()||null,p_usuario_auditoria:p()});if(a)throw a;i.success("Marca creada exitosamente");const{data:n}=await l.rpc("fn_leer_marcas");B(n||[]),c({...t,id_marca:r}),v({nombre:"",descripcion:""}),w(!1)}catch(r){console.error("Error:",r),i.error(r.message||"Error al crear marca")}finally{E(!1)}},ke=async()=>{if(!u.nombre.trim()){i.error("El nombre de la unidad es obligatorio");return}A(!0);try{const{data:r,error:a}=await l.rpc("fn_crear_unidad_medida",{p_nombre:u.nombre.trim(),p_abreviatura:u.abreviatura.trim()||null,p_descripcion:null,p_usuario_auditoria:p()});if(a)throw a;i.success("Unidad de medida creada exitosamente");const{data:n}=await l.rpc("fn_leer_unidades_medida");R(n||[]),c({...t,id_unidad:r}),y({nombre:"",abreviatura:""}),S(!1)}catch(r){console.error("Error:",r),i.error(r.message||"Error al crear unidad")}finally{A(!1)}},[F,P]=d.useState(null),[M,W]=d.useState(null),we=async()=>{if(!f.nombre.trim()){i.error("El nombre de la marca es obligatorio");return}E(!0);try{const{error:r}=await l.rpc("fn_actualizar_marca",{p_id_marca:F,p_nombre:f.nombre.trim(),p_descripcion:f.descripcion?.trim()||null,p_usuario_auditoria:p()});if(r)throw r;i.success("Marca actualizada exitosamente");const{data:a}=await l.rpc("fn_leer_marcas");B(a||[]),v({nombre:"",descripcion:""}),w(!1),P(null)}catch(r){console.error("Error:",r),i.error(r.message||"Error al actualizar marca")}finally{E(!1)}},Se=async(r,a)=>{if(window.confirm(`¿Estás seguro de eliminar la marca "${a}"?`))try{const{error:n}=await l.rpc("fn_desactivar_marca",{p_id_marca:r,p_usuario_auditoria:p()});if(n)throw n;i.success("Marca eliminada exitosamente");const{data:s}=await l.rpc("fn_leer_marcas");B(s||[]),t.id_marca===r&&c({...t,id_marca:""})}catch(n){console.error("Error:",n),i.error(n.message||"Error al eliminar marca")}},Ce=async()=>{if(!u.nombre.trim()){i.error("El nombre de la unidad es obligatorio");return}A(!0);try{const{error:r}=await l.rpc("fn_actualizar_unidad_medida",{p_id_unidad:M,p_nombre:u.nombre.trim(),p_abreviatura:u.abreviatura?.trim()||null,p_descripcion:null,p_usuario_auditoria:p()});if(r)throw r;i.success("Unidad actualizada exitosamente");const{data:a}=await l.rpc("fn_leer_unidades_medida");R(a||[]),y({nombre:"",abreviatura:""}),S(!1),W(null)}catch(r){console.error("Error:",r),i.error(r.message||"Error al actualizar unidad")}finally{A(!1)}},ze=async(r,a)=>{if(window.confirm(`¿Estás seguro de eliminar la unidad "${a}"?`))try{const{error:n}=await l.rpc("fn_desactivar_unidad_medida",{p_id_unidad:r,p_usuario_auditoria:p()});if(n)throw n;i.success("Unidad eliminada exitosamente");const{data:s}=await l.rpc("fn_leer_unidades_medida");R(s||[]),t.id_unidad===r&&c({...t,id_unidad:""})}catch(n){console.error("Error:",n),i.error(n.message||"Error al eliminar unidad")}},Be=r=>{P(r.id_marca),v({nombre:r.nombre,descripcion:r.descripcion||""}),w(!0)},Re=r=>{W(r.id_unidad),y({nombre:r.nombre,abreviatura:r.abreviatura||""}),S(!0)},ie=()=>{const r=Date.now().toString().slice(-6),a=Math.random().toString(36).substring(2,5).toUpperCase();return`PROD-${r}-${a}`},ne=()=>{const a="1234",n=String(Math.floor(Math.random()*1e5)).padStart(5,"0"),s="777"+a+n;let j=0;for(let k=0;k<12;k++)j+=parseInt(s[k])*(k%2===0?1:3);const D=(10-j%10)%10;return s+D},se=async r=>{if(!r)return null;re(!0);try{const a=r.name.split(".").pop(),s=`${`producto_${Date.now()}.${a}`}`,{data:j,error:D}=await l.storage.from("productos").upload(s,r,{cacheControl:"3600",upsert:!1});if(D)throw D;const{data:k}=l.storage.from("productos").getPublicUrl(s);return k.publicUrl}catch(a){return console.error("Error subiendo foto:",a),i.error("Error al subir la imagen"),null}finally{re(!1)}},Ie=r=>{const a=r.target.files[0];if(a){if(!a.type.startsWith("image/")){i.error("Solo se permiten imágenes");return}if(a.size>5*1024*1024){i.error("La imagen no debe superar 5MB");return}const n=new FileReader;n.onloadend=()=>h(n.result),n.readAsDataURL(a),c({...t,fotoFile:a})}},Ee=()=>{h(null),c({...t,foto_url:"",fotoFile:null})};d.useEffect(()=>{le()},[]);const le=async()=>{Z(!0);try{const[r,a,n,s,j]=await Promise.all([l.rpc("fn_leer_productos",{p_buscar:b||null,p_categoria_id:m?parseInt(m):null}),l.rpc("fn_leer_categorias"),l.rpc("fn_leer_proveedores",{p_buscar_texto:null}),l.rpc("fn_leer_marcas"),l.rpc("fn_leer_unidades_medida")]);if(r.error)throw r.error;if(a.error)throw a.error;if(n.error)throw n.error;s.error&&console.warn("Marcas no disponibles:",s.error),j.error&&console.warn("Unidades no disponibles:",j.error),X(r.data||[]),fe(a.data||[]),he(n.data||[]),B(s.data||[]),R(j.data||[])}catch(r){console.error("Error:",r),i.error("Error al cargar datos")}finally{Z(!1)}};d.useEffect(()=>{const r=setTimeout(()=>{U()},300);return()=>clearTimeout(r)},[b,m]);const U=async()=>{try{const{data:r,error:a}=await l.rpc("fn_leer_productos",{p_buscar:b||null,p_categoria_id:m?parseInt(m):null});if(a)throw a;X(r||[])}catch(r){console.error("Error:",r)}},Ae=async()=>{if(!t.nombre.trim()||!t.codigo_interno.trim()){i.error("Código interno y nombre son obligatorios");return}if(!t.categoria_id){i.error("Seleccione una categoría");return}if(!t.precio_venta||parseFloat(t.precio_venta)<=0){i.error("El precio de venta es obligatorio");return}I(!0);try{const{data:r,error:a}=await l.rpc("fn_crear_producto_v2",{p_codigo_interno:t.codigo_interno.trim(),p_codigo_barras:t.codigo_barras.trim()||null,p_nombre:t.nombre.trim(),p_id_categoria:t.categoria_id,p_id_marca:t.id_marca||null,p_id_unidad:t.id_unidad||null,p_precio_costo:parseFloat(t.precio_costo)||0,p_precio_venta:parseFloat(t.precio_venta),p_stock_minimo:parseInt(t.stock_minimo)||10,p_stock_maximo:parseInt(t.stock_maximo)||100,p_controla_vencimiento:t.controla_vencimiento,p_usuario_auditoria:p()});if(a)a.message.includes("ya existe")?i.error("El código interno ya está registrado"):i.error(a.message||"Error al crear producto");else{if(t.fotoFile&&r){const n=await se(t.fotoFile);n&&await l.rpc("fn_actualizar_foto_producto",{p_id_producto:r,p_foto_url:n,p_usuario_auditoria:p()})}if(t.proveedor_id&&r)try{const{error:n}=await l.rpc("fn_asociar_producto_proveedor",{p_id_producto:r,p_id_proveedor:t.proveedor_id,p_precio_compra:parseFloat(t.precio_costo)||0,p_usuario_auditoria:p()});n?(console.error("Error al asociar proveedor:",n),i.success("Producto creado, pero hubo un error al asociar proveedor")):i.success("Producto creado y asociado al proveedor")}catch(n){console.error("Error:",n),i.success("Producto creado exitosamente")}else i.success("Producto creado exitosamente");_(!1),h(null),ce(),U()}}catch(r){console.error("Error:",r),i.error("Error al crear producto")}finally{I(!1)}},Fe=async()=>{if(!t.nombre.trim()){i.error("El nombre es obligatorio");return}if(!t.categoria_id){i.error("Seleccione una categoría");return}I(!0);try{const{error:r}=await l.rpc("fn_actualizar_producto_v2",{p_id:x.id,p_codigo_barras:t.codigo_barras.trim()||null,p_nombre:t.nombre.trim(),p_categoria_id:parseInt(t.categoria_id),p_id_marca:t.id_marca||null,p_id_unidad:t.id_unidad||null,p_precio_costo:parseFloat(t.precio_costo)||0,p_precio_venta:parseFloat(t.precio_venta),p_stock_minimo:parseInt(t.stock_minimo)||10,p_stock_maximo:parseInt(t.stock_maximo)||100,p_usuario_auditoria:p()});if(r)i.error(r.message||"Error al actualizar");else{if(t.fotoFile){const a=await se(t.fotoFile);a&&await l.rpc("fn_actualizar_foto_producto",{p_id_producto:x.id,p_foto_url:a,p_usuario_auditoria:p()})}if(t.proveedor_id)try{const{error:a}=await l.rpc("fn_asociar_producto_proveedor",{p_id_producto:x.id,p_id_proveedor:t.proveedor_id,p_precio_compra:parseFloat(t.precio_costo)||0,p_usuario_auditoria:p()});a&&console.error("Error al asociar proveedor:",a)}catch(a){console.error("Error asociando proveedor:",a)}i.success("Producto actualizado exitosamente"),_(!1),h(null),ce(),U()}}catch{i.error("Error al actualizar")}finally{I(!1)}},Pe=async(r,a)=>{const n=window.prompt(`¿Eliminar "${a}"?

Ingrese el motivo de eliminación:`);if(n)try{const{error:s}=await l.rpc("fn_eliminar_producto",{p_id:r,p_motivo:n,p_usuario_auditoria:p()});s?s.message.includes("stock")?i.error("No se puede eliminar: tiene stock. Realice un ajuste primero."):i.error(s.message||"Error al eliminar"):(i.success("Producto eliminado"),U())}catch{i.error("Error al eliminar")}},Me=async r=>{V(r),h(null);try{const{data:a,error:n}=await l.rpc("fn_obtener_producto_por_id",{p_id:r.id});if(a&&a[0]){const s=a[0];c({codigo_interno:s.codigo_interno||"",codigo_barras:s.codigo_barras||"",nombre:s.nombre||"",categoria_id:s.categoria_id||"",id_marca:s.id_marca||"",id_unidad:s.id_unidad||"",proveedor_id:s.proveedor_id||"",precio_costo:s.precio_costo||"",precio_venta:s.precio_venta||"",stock_minimo:s.stock_minimo||10,stock_maximo:s.stock_maximo||100,presentacion:s.presentacion||"",controla_vencimiento:s.controla_vencimiento||!1,foto_url:s.foto_url||"",fotoFile:null})}else c({codigo_interno:r.codigo_interno||"",codigo_barras:r.codigo_barras||"",nombre:r.nombre||"",categoria_id:"",id_marca:r.id_marca||"",id_unidad:r.id_unidad||"",proveedor_id:"",precio_costo:"",precio_venta:r.precio_venta||"",stock_minimo:r.stock_minimo||10,stock_maximo:100,presentacion:"",controla_vencimiento:!1,foto_url:r.foto_url||"",fotoFile:null})}catch(a){console.error("Error al obtener producto:",a)}_(!0)},de=()=>{V(null),h(null),c({codigo_interno:ie(),codigo_barras:ne(),nombre:"",categoria_id:"",id_marca:"",id_unidad:"",proveedor_id:"",precio_costo:"",precio_venta:"",stock_minimo:10,stock_maximo:100,presentacion:"",controla_vencimiento:!1,foto_url:"",fotoFile:null}),_(!0)},ce=()=>{c({codigo_interno:"",codigo_barras:"",nombre:"",categoria_id:"",id_marca:"",id_unidad:"",proveedor_id:"",precio_costo:"",precio_venta:"",stock_minimo:10,stock_maximo:100,presentacion:"",controla_vencimiento:!1,foto_url:"",fotoFile:null}),V(null),h(null)},We=r=>{const a={CRITICO:{bg:"#ffebee",color:"#c62828",icon:e.jsx(He,{size:12})},BAJO:{bg:"#fff3e0",color:"#e65100",icon:e.jsx(Ne,{size:12})},NORMAL:{bg:"#e8f5e9",color:"#2e7d32",icon:e.jsx(Ue,{size:12})},SOBRESTOCK:{bg:"#e3f2fd",color:"#1565c0",icon:e.jsx($e,{size:12})}};return a[r]||a.NORMAL},N={total:g.length,critico:g.filter(r=>r.estado_stock==="CRITICO").length,bajo:g.filter(r=>r.estado_stock==="BAJO").length,normal:g.filter(r=>r.estado_stock==="NORMAL").length};return e.jsxs("div",{style:o.container,children:[e.jsx(De,{position:"top-right"}),e.jsxs("header",{style:o.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{style:o.title,children:[e.jsx(q,{size:28,style:{marginRight:"12px"}}),"Productos"]}),e.jsxs("p",{style:o.subtitle,children:["Catálogo de productos • ",g.length," registros"]})]}),e.jsxs("button",{style:o.primaryButton,onClick:de,children:[e.jsx(T,{size:18}),"Nuevo Producto"]})]}),e.jsxs("div",{style:o.statsRow,children:[e.jsxs("div",{style:{...o.statCard,borderLeft:"4px solid #1a5d1a"},children:[e.jsx("span",{style:o.statValue,children:N.total}),e.jsx("span",{style:o.statLabel,children:"Total"})]}),e.jsxs("div",{style:{...o.statCard,borderLeft:"4px solid #c62828"},children:[e.jsx("span",{style:{...o.statValue,color:"#c62828"},children:N.critico}),e.jsx("span",{style:o.statLabel,children:"Sin Stock"})]}),e.jsxs("div",{style:{...o.statCard,borderLeft:"4px solid #e65100"},children:[e.jsx("span",{style:{...o.statValue,color:"#e65100"},children:N.bajo}),e.jsx("span",{style:o.statLabel,children:"Bajo Stock"})]}),e.jsxs("div",{style:{...o.statCard,borderLeft:"4px solid #2e7d32"},children:[e.jsx("span",{style:{...o.statValue,color:"#2e7d32"},children:N.normal}),e.jsx("span",{style:o.statLabel,children:"Normal"})]})]}),e.jsxs("div",{style:o.toolbar,children:[e.jsxs("div",{style:o.searchBox,children:[e.jsx(Te,{size:18,style:{color:"#6c757d"}}),e.jsx("input",{type:"text",placeholder:"Buscar por nombre o código...",value:b,onChange:r=>oe(r.target.value),style:o.searchInput}),b&&e.jsx("button",{onClick:()=>oe(""),style:o.clearButton,children:e.jsx(C,{size:16})})]}),e.jsxs("select",{value:m,onChange:r=>be(r.target.value),style:o.select,children:[e.jsx("option",{value:"",children:"Todas las categorías"}),Y.map(r=>e.jsx("option",{value:r.id,children:r.nombre},r.id))]}),e.jsxs("button",{style:o.refreshButton,onClick:le,disabled:O,children:[e.jsx(z,{size:16,style:{animation:O?"spin 1s linear infinite":"none"}}),"Actualizar"]})]}),e.jsx("div",{style:o.tableContainer,children:O?e.jsxs("div",{style:o.loadingState,children:[e.jsx(z,{size:40,style:{animation:"spin 1s linear infinite",color:"#1a5d1a"}}),e.jsx("p",{children:"Cargando productos..."})]}):g.length===0?e.jsxs("div",{style:o.emptyState,children:[e.jsx(q,{size:48,style:{color:"#ccc"}}),e.jsx("p",{children:b||m?"No se encontraron resultados":"No hay productos registrados"}),!b&&!m&&e.jsxs("button",{style:o.primaryButton,onClick:de,children:[e.jsx(T,{size:18})," Crear primer producto"]})]}):e.jsxs("table",{style:o.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:o.th,children:"Imagen"}),e.jsx("th",{style:o.th,children:"Código"}),e.jsx("th",{style:o.th,children:"Producto"}),e.jsx("th",{style:o.th,children:"Categoría"}),e.jsx("th",{style:o.th,children:"Precio Venta"}),e.jsx("th",{style:o.th,children:"Stock"}),e.jsx("th",{style:o.th,children:"Estado"}),e.jsx("th",{style:{...o.th,textAlign:"center"},children:"Acciones"})]})}),e.jsx("tbody",{children:g.map(r=>{const a=We(r.estado_stock);return e.jsxs("tr",{style:o.tr,children:[e.jsx("td",{style:o.td,children:r.foto_url?e.jsx("img",{src:r.foto_url,alt:r.nombre,style:o.tableFotoImg}):e.jsx("div",{style:o.tableFotoPlaceholder,children:e.jsx(q,{size:20,style:{color:"#ccc"}})})}),e.jsx("td",{style:o.td,children:e.jsx("code",{style:o.code,children:r.codigo_interno})}),e.jsx("td",{style:o.td,children:e.jsxs("div",{children:[e.jsx("strong",{children:r.nombre}),r.marca&&e.jsx("span",{style:o.marca,children:r.marca})]})}),e.jsx("td",{style:o.td,children:r.categoria||"-"}),e.jsx("td",{style:o.td,children:e.jsxs("strong",{style:{color:"#1a5d1a"},children:["Bs ",parseFloat(r.precio_venta||0).toFixed(2)]})}),e.jsxs("td",{style:o.td,children:[e.jsx("span",{style:{fontWeight:"600"},children:r.stock_actual}),e.jsxs("span",{style:{color:"#999",fontSize:"12px"},children:[" / mín: ",r.stock_minimo]})]}),e.jsx("td",{style:o.td,children:e.jsxs("span",{style:{...o.badge,background:a.bg,color:a.color},children:[a.icon,r.estado_stock]})}),e.jsx("td",{style:{...o.td,textAlign:"center"},children:e.jsxs("div",{style:o.actionButtons,children:[e.jsx("button",{style:o.editButton,onClick:()=>Me(r),children:e.jsx(J,{size:16})}),e.jsx("button",{style:o.deleteButton,onClick:()=>Pe(r.id,r.nombre),children:e.jsx(K,{size:16})})]})})]},r.id)})})]})}),_e&&e.jsx("div",{style:o.modalOverlay,onClick:()=>_(!1),children:e.jsxs("div",{style:o.modal,onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{style:o.modalHeader,children:[e.jsx("h2",{style:o.modalTitle,children:x?"Editar Producto":"Nuevo Producto"}),e.jsx("button",{style:o.closeButton,onClick:()=>_(!1),children:e.jsx(C,{size:20})})]}),e.jsxs("div",{style:o.modalBody,children:[!x&&e.jsxs("div",{style:o.infoBox,children:[e.jsx(Ke,{size:24,style:{color:"#1a5d1a"}}),e.jsxs("div",{children:[e.jsx("strong",{children:"Códigos generados automáticamente"}),e.jsx("p",{style:{margin:"4px 0 0 0",fontSize:"12px",opacity:.8},children:"El código interno y código de barras se han generado automáticamente. Solo completa los datos del producto."})]})]}),e.jsxs("div",{style:o.formRow,children:[e.jsxs("div",{style:o.formGroup,children:[e.jsxs("label",{style:o.label,children:["Código Interno",e.jsx("span",{style:o.autoBadge,children:"Auto"})]}),e.jsxs("div",{style:o.codeInputWrapper,children:[e.jsx("input",{type:"text",value:t.codigo_interno,style:{...o.input,...o.codeInput},readOnly:!0}),!x&&e.jsx("button",{type:"button",style:o.regenerateButton,onClick:()=>c({...t,codigo_interno:ie()}),title:"Regenerar código",children:e.jsx(pe,{size:16})})]})]}),e.jsxs("div",{style:o.formGroup,children:[e.jsxs("label",{style:o.label,children:["Código de Barras (EAN-13)",e.jsx("span",{style:o.autoBadge,children:"Auto"})]}),e.jsxs("div",{style:o.codeInputWrapper,children:[e.jsx("input",{type:"text",value:t.codigo_barras,style:{...o.input,...o.codeInput},readOnly:!0}),!x&&e.jsx("button",{type:"button",style:o.regenerateButton,onClick:()=>c({...t,codigo_barras:ne()}),title:"Regenerar código",children:e.jsx(pe,{size:16})})]})]})]}),e.jsx("div",{style:o.formRow,children:e.jsxs("div",{style:{...o.formGroup,flex:1},children:[e.jsx("label",{style:o.label,children:"Nombre del Producto *"}),e.jsx("input",{type:"text",value:t.nombre,onChange:r=>c({...t,nombre:r.target.value}),style:{...o.input,fontSize:"16px",padding:"14px 15px"},placeholder:"Ej: Leche PIL Entera 1L, Arroz Grano de Oro 1Kg...",autoFocus:!0})]})}),e.jsxs("div",{style:o.formRow,children:[e.jsxs("div",{style:o.formGroup,children:[e.jsx("label",{style:o.label,children:"Categoría *"}),e.jsxs("select",{value:t.categoria_id,onChange:r=>c({...t,categoria_id:r.target.value}),style:o.input,children:[e.jsx("option",{value:"",children:"Seleccione categoría..."}),Y.map(r=>e.jsx("option",{value:r.id,children:r.nombre},r.id))]})]}),e.jsxs("div",{style:o.formGroup,children:[e.jsxs("label",{style:o.label,children:[e.jsx(me,{size:16}),"Marca"]}),ye?e.jsxs("div",{style:o.inlineAddForm,children:[e.jsxs("div",{style:o.inlineAddHeader,children:[e.jsx(me,{size:16,style:{color:"#1a5d1a"}}),e.jsx("span",{style:o.inlineAddTitle,children:F?"Editar Marca":"Nueva Marca"})]}),e.jsx("input",{type:"text",value:f.nombre,onChange:r=>v({...f,nombre:r.target.value}),style:{...o.input,marginBottom:"10px"},placeholder:"Nombre de la marca",autoFocus:!0}),e.jsxs("div",{style:o.inlineAddActions,children:[e.jsxs("button",{type:"button",onClick:F?we:ve,disabled:te,style:o.inlineAddButton,children:[te?e.jsx(z,{size:14,style:{animation:"spin 1s linear infinite"}}):e.jsx(ue,{size:14}),F?"Actualizar":"Guardar"]}),e.jsxs("button",{type:"button",onClick:()=>{w(!1),P(null),v({nombre:"",descripcion:""})},style:o.inlineCancelButton,children:[e.jsx(C,{size:14}),"Cancelar"]})]})]}):e.jsxs("div",{style:o.selectWithActions,children:[e.jsxs("div",{style:o.selectWithButton,children:[e.jsxs("select",{value:t.id_marca,onChange:r=>c({...t,id_marca:r.target.value}),style:{...o.input,flex:1,borderRadius:"10px 0 0 10px"},children:[e.jsx("option",{value:"",children:"Seleccione marca..."}),G.map(r=>e.jsx("option",{value:r.id_marca,children:r.nombre},r.id_marca))]}),e.jsx("button",{type:"button",onClick:()=>{P(null),v({nombre:"",descripcion:""}),w(!0)},style:o.addNewButton,title:"Agregar nueva marca",children:e.jsx(T,{size:18})})]}),t.id_marca&&e.jsxs("div",{style:o.itemActions,children:[e.jsx("button",{type:"button",onClick:()=>{const r=G.find(a=>a.id_marca===t.id_marca);r&&Be(r)},style:o.iconButton,title:"Editar marca",children:e.jsx(J,{size:14})}),e.jsx("button",{type:"button",onClick:()=>{const r=G.find(a=>a.id_marca===t.id_marca);r&&Se(r.id_marca,r.nombre)},style:o.iconButtonDanger,title:"Eliminar marca",children:e.jsx(K,{size:14})})]})]})]})]}),e.jsx("div",{style:o.formRow,children:e.jsxs("div",{style:o.formGroup,children:[e.jsx("label",{style:o.label,children:"Proveedor Principal"}),e.jsxs("select",{value:t.proveedor_id,onChange:r=>c({...t,proveedor_id:r.target.value}),style:o.input,children:[e.jsx("option",{value:"",children:"Seleccione proveedor (opcional)..."}),ge.map(r=>e.jsx("option",{value:r.id,children:r.razon_social},r.id))]})]})}),e.jsxs("div",{style:o.formRow,children:[e.jsxs("div",{style:o.formGroup,children:[e.jsx("label",{style:o.label,children:"Precio Costo (Bs)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.precio_costo,onChange:r=>c({...t,precio_costo:r.target.value}),style:o.input,placeholder:"0.00"})]}),e.jsxs("div",{style:o.formGroup,children:[e.jsx("label",{style:o.label,children:"Precio Venta (Bs) *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.precio_venta,onChange:r=>c({...t,precio_venta:r.target.value}),style:o.input,placeholder:"0.00"})]})]}),e.jsxs("div",{style:o.formRow,children:[e.jsxs("div",{style:o.formGroup,children:[e.jsx("label",{style:o.label,children:"Stock Mínimo"}),e.jsx("input",{type:"number",min:"0",value:t.stock_minimo,onChange:r=>c({...t,stock_minimo:r.target.value}),style:o.input})]}),e.jsxs("div",{style:o.formGroup,children:[e.jsx("label",{style:o.label,children:"Stock Máximo"}),e.jsx("input",{type:"number",min:"0",value:t.stock_maximo,onChange:r=>c({...t,stock_maximo:r.target.value}),style:o.input})]}),e.jsxs("div",{style:o.formGroup,children:[e.jsxs("label",{style:o.label,children:[e.jsx(xe,{size:16}),"Unidad de Medida"]}),je?e.jsxs("div",{style:o.inlineAddForm,children:[e.jsxs("div",{style:o.inlineAddHeader,children:[e.jsx(xe,{size:16,style:{color:"#1a5d1a"}}),e.jsx("span",{style:o.inlineAddTitle,children:M?"Editar Unidad":"Nueva Unidad de Medida"})]}),e.jsxs("div",{style:o.inlineAddFieldsRow,children:[e.jsx("input",{type:"text",value:u.nombre,onChange:r=>y({...u,nombre:r.target.value}),style:{...o.input,flex:2,minWidth:"120px"},placeholder:"Nombre (ej: GRAMO)",autoFocus:!0}),e.jsx("input",{type:"text",value:u.abreviatura,onChange:r=>y({...u,abreviatura:r.target.value}),style:{...o.input,flex:1,minWidth:"80px"},placeholder:"Abrev. (ej: GR)"})]}),e.jsxs("div",{style:o.inlineAddActions,children:[e.jsxs("button",{type:"button",onClick:M?Ce:ke,disabled:ae,style:o.inlineAddButton,children:[ae?e.jsx(z,{size:14,style:{animation:"spin 1s linear infinite"}}):e.jsx(ue,{size:14}),M?"Actualizar":"Guardar"]}),e.jsxs("button",{type:"button",onClick:()=>{S(!1),W(null),y({nombre:"",abreviatura:""})},style:o.inlineCancelButton,children:[e.jsx(C,{size:14}),"Cancelar"]})]})]}):e.jsxs("div",{style:o.selectWithActions,children:[e.jsxs("div",{style:o.selectWithButton,children:[e.jsxs("select",{value:t.id_unidad,onChange:r=>c({...t,id_unidad:r.target.value}),style:{...o.input,flex:1,borderRadius:"10px 0 0 10px"},children:[e.jsx("option",{value:"",children:"Seleccione unidad..."}),L.map(r=>e.jsxs("option",{value:r.id_unidad,children:[r.nombre," ",r.abreviatura&&`(${r.abreviatura})`]},r.id_unidad))]}),e.jsx("button",{type:"button",onClick:()=>{W(null),y({nombre:"",abreviatura:""}),S(!0)},style:o.addNewButton,title:"Agregar nueva unidad",children:e.jsx(T,{size:18})})]}),t.id_unidad&&e.jsxs("div",{style:o.itemActions,children:[e.jsx("button",{type:"button",onClick:()=>{const r=L.find(a=>a.id_unidad===t.id_unidad);r&&Re(r)},style:o.iconButton,title:"Editar unidad",children:e.jsx(J,{size:14})}),e.jsx("button",{type:"button",onClick:()=>{const r=L.find(a=>a.id_unidad===t.id_unidad);r&&ze(r.id_unidad,r.nombre)},style:o.iconButtonDanger,title:"Eliminar unidad",children:e.jsx(K,{size:14})})]})]})]})]}),e.jsxs("div",{style:o.formRow,children:[e.jsxs("div",{style:{...o.formGroup,flex:2},children:[e.jsx("label",{style:o.label,children:"Presentación"}),e.jsx("input",{type:"text",value:t.presentacion,onChange:r=>c({...t,presentacion:r.target.value}),style:o.input,placeholder:"Ej: Botella 500ml, Paquete 6 unidades"})]}),e.jsx("div",{style:{...o.formGroup,display:"flex",alignItems:"center",paddingTop:"25px"},children:e.jsxs("label",{style:o.checkbox,children:[e.jsx("input",{type:"checkbox",checked:t.controla_vencimiento,onChange:r=>c({...t,controla_vencimiento:r.target.checked})}),e.jsx("span",{children:"Controla vencimiento"})]})})]}),e.jsx("div",{style:o.formRow,children:e.jsxs("div",{style:{...o.formGroup,flex:1},children:[e.jsxs("label",{style:o.label,children:[e.jsx(Ge,{size:16}),"Foto del Producto (opcional)"]}),e.jsxs("div",{style:o.fotoSection,children:[e.jsx("div",{style:o.fotoPreview,children:H||t.foto_url?e.jsx("img",{src:H||t.foto_url,alt:"Preview",style:o.fotoImage}):e.jsxs("div",{style:o.fotoPlaceholder,children:[e.jsx(qe,{size:48,style:{color:"#ccc"}}),e.jsx("span",{children:"Sin imagen"})]})}),e.jsxs("div",{style:o.fotoActions,children:[e.jsxs("label",{style:o.uploadButton,children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:Ie,style:{display:"none"},disabled:ee}),e.jsx(Le,{size:16}),ee?"Subiendo...":"Seleccionar Imagen"]}),(H||t.foto_url)&&e.jsxs("button",{type:"button",style:o.removeFotoButton,onClick:Ee,children:[e.jsx(C,{size:16}),"Quitar"]}),e.jsx("span",{style:o.fotoHelp,children:"JPG, PNG o WebP. Máx 5MB."})]})]})]})})]}),e.jsxs("div",{style:o.modalFooter,children:[e.jsx("button",{style:o.cancelButton,onClick:()=>_(!1),disabled:$,children:"Cancelar"}),e.jsx("button",{style:o.saveButton,onClick:x?Fe:Ae,disabled:$,children:$?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:16,style:{animation:"spin 1s linear infinite"}})," Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{size:16})," ",x?"Actualizar":"Crear"]})})]})]})}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}const o={container:{padding:"20px",maxWidth:"1400px",margin:"0 auto"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"15px"},title:{margin:0,fontSize:"28px",fontWeight:"700",color:"#1a5d1a",display:"flex",alignItems:"center"},subtitle:{margin:"8px 0 0 0",color:"#6c757d",fontSize:"14px"},primaryButton:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 20px",background:"linear-gradient(135deg, #1a5d1a, #2e8b57)",color:"white",border:"none",borderRadius:"10px",fontSize:"14px",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 12px rgba(26, 93, 26, 0.3)"},statsRow:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"15px",marginBottom:"20px"},statCard:{background:"white",padding:"15px 20px",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},statValue:{fontSize:"28px",fontWeight:"700",color:"#1a5d1a",display:"block"},statLabel:{fontSize:"13px",color:"#6c757d"},toolbar:{display:"flex",gap:"12px",marginBottom:"20px",flexWrap:"wrap"},searchBox:{display:"flex",alignItems:"center",gap:"10px",padding:"10px 15px",background:"white",border:"1px solid #e9ecef",borderRadius:"10px",flex:1,maxWidth:"350px"},searchInput:{border:"none",outline:"none",fontSize:"14px",width:"100%",background:"transparent"},clearButton:{background:"none",border:"none",cursor:"pointer",color:"#999",padding:"2px"},select:{padding:"10px 15px",border:"1px solid #e9ecef",borderRadius:"10px",fontSize:"14px",background:"white",minWidth:"180px"},refreshButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"white",border:"1px solid #e9ecef",borderRadius:"10px",fontSize:"14px",color:"#495057",cursor:"pointer"},tableContainer:{background:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",overflow:"auto"},table:{width:"100%",borderCollapse:"collapse",minWidth:"900px"},th:{padding:"15px 20px",textAlign:"left",background:"#f8f9fa",color:"#1a5d1a",fontWeight:"600",fontSize:"14px",borderBottom:"2px solid #e9ecef",whiteSpace:"nowrap"},tr:{borderBottom:"1px solid #e9ecef"},td:{padding:"15px 20px",fontSize:"14px",color:"#495057"},code:{background:"#f8f9fa",padding:"4px 8px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px"},marca:{display:"block",fontSize:"12px",color:"#6c757d",marginTop:"2px"},badge:{display:"inline-flex",alignItems:"center",gap:"5px",padding:"5px 10px",borderRadius:"20px",fontSize:"11px",fontWeight:"600"},actionButtons:{display:"flex",gap:"8px",justifyContent:"center"},editButton:{padding:"8px",background:"#e3f2fd",border:"none",borderRadius:"8px",cursor:"pointer",color:"#1976d2"},deleteButton:{padding:"8px",background:"#ffebee",border:"none",borderRadius:"8px",cursor:"pointer",color:"#d32f2f"},loadingState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",color:"#6c757d",gap:"15px"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"60px 20px",color:"#6c757d",gap:"15px"},modalOverlay:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},modal:{background:"white",borderRadius:"16px",width:"100%",maxWidth:"800px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden",maxHeight:"90vh",overflowY:"auto"},modalHeader:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px 25px",borderBottom:"1px solid #e9ecef",background:"linear-gradient(135deg, #f8f9fa, #e8f5e9)",position:"sticky",top:0,zIndex:10},modalTitle:{margin:0,fontSize:"20px",fontWeight:"600",color:"#1a5d1a"},closeButton:{background:"none",border:"none",cursor:"pointer",color:"#6c757d",padding:"5px",borderRadius:"5px"},modalBody:{padding:"25px"},formRow:{display:"flex",gap:"15px",marginBottom:"15px",flexWrap:"wrap"},formGroup:{flex:1,minWidth:"180px"},label:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#1a5d1a"},input:{width:"100%",padding:"12px 15px",border:"2px solid #e9ecef",borderRadius:"10px",fontSize:"14px",outline:"none",boxSizing:"border-box"},checkbox:{display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",cursor:"pointer"},modalFooter:{display:"flex",justifyContent:"flex-end",gap:"12px",padding:"20px 25px",borderTop:"1px solid #e9ecef",background:"#f8f9fa",position:"sticky",bottom:0},cancelButton:{padding:"10px 20px",background:"white",border:"1px solid #e9ecef",borderRadius:"8px",fontSize:"14px",cursor:"pointer",color:"#6c757d"},saveButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 20px",background:"linear-gradient(135deg, #1a5d1a, #2e8b57)",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer"},infoBox:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"15px",background:"linear-gradient(135deg, #e8f5e9, #c8e6c9)",borderRadius:"12px",marginBottom:"20px",border:"1px solid #a5d6a7"},autoBadge:{display:"inline-block",padding:"2px 8px",background:"#1a5d1a",color:"white",borderRadius:"10px",fontSize:"10px",fontWeight:"600",marginLeft:"8px"},codeInputWrapper:{display:"flex",gap:"8px",alignItems:"center"},codeInput:{background:"#f8f9fa",fontFamily:"monospace",fontSize:"13px",color:"#495057"},regenerateButton:{padding:"10px 12px",background:"white",border:"2px solid #e9ecef",borderRadius:"10px",cursor:"pointer",fontSize:"16px",transition:"all 0.2s"},fotoSection:{display:"flex",gap:"20px",alignItems:"flex-start",flexWrap:"wrap"},fotoPreview:{width:"150px",height:"150px",border:"2px dashed #e9ecef",borderRadius:"12px",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",background:"#f8f9fa"},fotoImage:{width:"100%",height:"100%",objectFit:"cover"},fotoPlaceholder:{display:"flex",flexDirection:"column",alignItems:"center",gap:"8px",color:"#999",fontSize:"12px"},fotoActions:{display:"flex",flexDirection:"column",gap:"10px"},uploadButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"#e8f5e9",color:"#1a5d1a",border:"2px solid #1a5d1a",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},removeFotoButton:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",background:"#ffebee",color:"#c62828",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px"},fotoHelp:{fontSize:"12px",color:"#6c757d"},tableFotoImg:{width:"50px",height:"50px",borderRadius:"10px",objectFit:"cover",border:"2px solid #e8f5e9",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",background:"linear-gradient(135deg, #f8f9fa, #e8f5e9)"},tableFotoPlaceholder:{width:"50px",height:"50px",background:"linear-gradient(135deg, #f8f9fa, #e9ecef)",borderRadius:"10px",display:"flex",alignItems:"center",justifyContent:"center",border:"2px dashed #dee2e6"},selectWithButton:{display:"flex",alignItems:"stretch"},addNewButton:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 14px",background:"linear-gradient(135deg, #1a5d1a, #2e8b57)",color:"white",border:"none",borderTopRightRadius:"10px",borderBottomRightRadius:"10px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(26, 93, 26, 0.2)"},inlineAddForm:{padding:"14px",background:"linear-gradient(135deg, #f8fdf8, #e8f5e9)",borderRadius:"12px",border:"2px solid #a5d6a7",boxShadow:"0 4px 12px rgba(26, 93, 26, 0.1)"},inlineAddHeader:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px",paddingBottom:"10px",borderBottom:"1px solid #c8e6c9"},inlineAddTitle:{fontSize:"14px",fontWeight:"600",color:"#1a5d1a"},inlineAddFieldsRow:{display:"flex",gap:"10px",marginBottom:"12px"},inlineAddActions:{display:"flex",gap:"10px",justifyContent:"flex-end"},inlineAddButton:{display:"flex",alignItems:"center",gap:"6px",padding:"10px 18px",background:"linear-gradient(135deg, #1a5d1a, #2e8b57)",color:"white",border:"none",borderRadius:"8px",fontSize:"13px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(26, 93, 26, 0.25)",transition:"all 0.2s ease"},inlineCancelButton:{display:"flex",alignItems:"center",gap:"6px",padding:"10px 18px",background:"white",color:"#6c757d",border:"1px solid #dee2e6",borderRadius:"8px",fontSize:"13px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},selectWithActions:{display:"flex",flexDirection:"column",gap:"8px"},itemActions:{display:"flex",gap:"6px",flexWrap:"wrap"},iconButton:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 12px",background:"#e3f2fd",color:"#1976d2",border:"none",borderRadius:"8px",fontSize:"12px",cursor:"pointer",transition:"all 0.2s ease",gap:"4px"},iconButtonDanger:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 12px",background:"#ffebee",color:"#d32f2f",border:"none",borderRadius:"8px",fontSize:"12px",cursor:"pointer",transition:"all 0.2s ease",gap:"4px"}};export{pr as default};

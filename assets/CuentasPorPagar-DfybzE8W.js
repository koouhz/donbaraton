import{r as l,s as u,j as e,m as d,C as c,i as b,b as C}from"./index-DyRGlXyn.js";import{F as v,L as _}from"./index-Bk6qzOxF.js";import{D as z}from"./dollar-sign-BJpoOmkd.js";import{C as S}from"./clock-B6XNtadS.js";function k(){const[n,p]=l.useState([]),[h,x]=l.useState(!0);l.useEffect(()=>{m()},[]);const m=async()=>{x(!0);try{const{data:s,error:a}=await u.rpc("fn_leer_cuentas_por_pagar");if(a)throw a;const r=(s||[]).map(o=>({id:o.id,factura_nro:o.factura_nro,fecha_vencimiento:o.fecha_vencimiento,monto_total:o.monto_total,saldo_pendiente:o.saldo_pendiente,estado:o.estado,proveedores:{razon_social:o.proveedor}}));p(r)}catch(s){console.error("Error:",s),p([])}finally{x(!1)}},i=s=>`Bs ${parseFloat(s||0).toFixed(2)}`,f=s=>new Date(s).toLocaleDateString("es-BO"),y=(s,a)=>{if(s==="PAGADA")return{bg:"#e8f5e9",color:"#2e7d32",icon:e.jsx(b,{size:14})};const r=Math.ceil((new Date(a)-new Date)/(1e3*60*60*24));return r<0?{bg:"#ffebee",color:"#c62828",icon:e.jsx(c,{size:14})}:r<=7?{bg:"#fff3e0",color:"#e65100",icon:e.jsx(S,{size:14})}:{bg:"#e3f2fd",color:"#1565c0",icon:e.jsx(C,{size:14})}},g=n.filter(s=>s.estado!=="PAGADA").reduce((s,a)=>s+parseFloat(a.saldo_pendiente||0),0),j=n.filter(s=>s.estado!=="PAGADA"&&new Date(s.fecha_vencimiento)<new Date).length;return e.jsxs("div",{style:t.container,children:[e.jsx(v,{position:"top-right"}),e.jsx("header",{style:t.header,children:e.jsxs("div",{children:[e.jsxs("h1",{style:t.title,children:[e.jsx(d,{size:28,style:{marginRight:"12px"}}),"Cuentas por Pagar"]}),e.jsx("p",{style:t.subtitle,children:"Gestión de deudas con proveedores"})]})}),e.jsxs("div",{style:t.summaryCards,children:[e.jsxs("div",{style:t.summaryCard,children:[e.jsx(z,{size:28,style:{color:"#c62828"}}),e.jsxs("div",{children:[e.jsx("span",{style:{...t.summaryValue,color:"#c62828"},children:i(g)}),e.jsx("span",{style:t.summaryLabel,children:"Total Pendiente"})]})]}),e.jsxs("div",{style:t.summaryCard,children:[e.jsx(d,{size:28,style:{color:"#1a5d1a"}}),e.jsxs("div",{children:[e.jsx("span",{style:t.summaryValue,children:n.length}),e.jsx("span",{style:t.summaryLabel,children:"Total Cuentas"})]})]}),e.jsxs("div",{style:t.summaryCard,children:[e.jsx(c,{size:28,style:{color:"#e65100"}}),e.jsxs("div",{children:[e.jsx("span",{style:{...t.summaryValue,color:"#e65100"},children:j}),e.jsx("span",{style:t.summaryLabel,children:"Vencidas"})]})]})]}),e.jsxs("div",{style:t.infoCard,children:[e.jsx(c,{size:18}),e.jsx("p",{children:"Las cuentas por pagar se generan automáticamente al recepcionar órdenes de compra."})]}),e.jsx("div",{style:t.tableContainer,children:h?e.jsx("div",{style:t.loadingState,children:e.jsx(_,{size:40,style:{animation:"spin 1s linear infinite",color:"#1a5d1a"}})}):n.length===0?e.jsxs("div",{style:t.emptyState,children:[e.jsx(d,{size:48,style:{color:"#ccc"}}),e.jsx("p",{children:"No hay cuentas por pagar"})]}):e.jsxs("table",{style:t.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:t.th,children:"Proveedor"}),e.jsx("th",{style:t.th,children:"Factura"}),e.jsx("th",{style:t.th,children:"Vencimiento"}),e.jsx("th",{style:t.th,children:"Monto Total"}),e.jsx("th",{style:t.th,children:"Saldo Pendiente"}),e.jsx("th",{style:t.th,children:"Estado"})]})}),e.jsx("tbody",{children:n.map((s,a)=>{const r=y(s.estado,s.fecha_vencimiento);return e.jsxs("tr",{style:t.tr,children:[e.jsx("td",{style:t.td,children:e.jsx("strong",{children:s.proveedores?.razon_social||"N/A"})}),e.jsx("td",{style:t.td,children:s.factura_nro||"-"}),e.jsx("td",{style:t.td,children:f(s.fecha_vencimiento)}),e.jsx("td",{style:t.td,children:i(s.monto_total)}),e.jsx("td",{style:{...t.td,fontWeight:"700",color:s.saldo_pendiente>0?"#c62828":"#2e7d32"},children:i(s.saldo_pendiente)}),e.jsx("td",{style:t.td,children:e.jsxs("span",{style:{...t.badge,background:r.bg,color:r.color},children:[r.icon,s.estado]})})]},s.id||a)})})]})}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}const t={container:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},title:{margin:0,fontSize:"28px",fontWeight:"700",color:"#1a5d1a",display:"flex",alignItems:"center"},subtitle:{margin:"8px 0 0 0",color:"#6c757d",fontSize:"14px"},summaryCards:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"15px",marginBottom:"20px"},summaryCard:{display:"flex",alignItems:"center",gap:"15px",padding:"20px",background:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},summaryValue:{display:"block",fontSize:"24px",fontWeight:"700",color:"#1a5d1a"},summaryLabel:{fontSize:"13px",color:"#6c757d"},infoCard:{display:"flex",alignItems:"center",gap:"12px",padding:"15px 20px",background:"#e3f2fd",borderRadius:"10px",marginBottom:"20px",color:"#1565c0",fontSize:"14px"},tableContainer:{background:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",overflow:"auto"},table:{width:"100%",borderCollapse:"collapse",minWidth:"800px"},th:{padding:"15px 20px",textAlign:"left",background:"#f8f9fa",color:"#1a5d1a",fontWeight:"600",fontSize:"14px",borderBottom:"2px solid #e9ecef"},tr:{borderBottom:"1px solid #e9ecef"},td:{padding:"15px 20px",fontSize:"14px",color:"#495057"},badge:{display:"inline-flex",alignItems:"center",gap:"5px",padding:"5px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600"},loadingState:{display:"flex",justifyContent:"center",padding:"60px"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",padding:"60px",color:"#6c757d",gap:"15px"}};export{k as default};

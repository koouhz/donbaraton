import{c as g,r as n,s as y,j as e,P as m,b as j}from"./index-hR7h3xft.js";import{n as u,F as b,L as v}from"./index-BTmhdvE4.js";import{C as S,a as C}from"./circle-arrow-up-CYSuU9gB.js";const z=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],p=g("history",z);function w(){const[a,d]=n.useState([]),[x,l]=n.useState(!0);n.useEffect(()=>{h()},[]);const h=async()=>{l(!0);try{const{data:o,error:s}=await y.rpc("fn_leer_movimientos_inventario");if(s)throw s;const r=(o||[]).map(i=>({id:i.id,fecha:i.fecha,tipo:i.tipo,cantidad:i.cantidad,documento:i.documento,motivo:i.motivo,productos:{nombre:i.producto}}));d(r)}catch(o){console.error("Error:",o),u.error("Error al cargar movimientos"),d([])}finally{l(!1)}},c=o=>["ENTRADA","AJUSTE+","DEVOLUCION_VENTA"].includes(o)?{bg:"#e8f5e9",color:"#2e7d32",icon:e.jsx(S,{size:16})}:{bg:"#ffebee",color:"#c62828",icon:e.jsx(C,{size:16})},f=o=>new Date(o).toLocaleDateString("es-BO");return e.jsxs("div",{style:t.container,children:[e.jsx(b,{position:"top-right"}),e.jsx("header",{style:t.header,children:e.jsxs("div",{children:[e.jsxs("h1",{style:t.title,children:[e.jsx(p,{size:28,style:{marginRight:"12px"}}),"Movimientos de Inventario"]}),e.jsx("p",{style:t.subtitle,children:"Historial de entradas y salidas de stock (Kardex)"})]})}),e.jsxs("div",{style:t.infoCard,children:[e.jsx(m,{size:20}),e.jsx("p",{children:"Los movimientos se registran automáticamente al realizar ventas, recepciones de compra, devoluciones y ajustes de inventario."})]}),e.jsx("div",{style:t.tableContainer,children:x?e.jsxs("div",{style:t.loadingState,children:[e.jsx(v,{size:40,style:{animation:"spin 1s linear infinite",color:"#1a5d1a"}}),e.jsx("p",{children:"Cargando movimientos..."})]}):a.length===0?e.jsxs("div",{style:t.emptyState,children:[e.jsx(p,{size:48,style:{color:"#ccc"}}),e.jsx("p",{children:"No hay movimientos registrados"}),e.jsx("span",{style:{color:"#999"},children:"Los movimientos aparecerán aquí cuando se realicen ventas o compras"})]}):e.jsxs("table",{style:t.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:t.th,children:"Fecha"}),e.jsx("th",{style:t.th,children:"Producto"}),e.jsx("th",{style:t.th,children:"Tipo"}),e.jsx("th",{style:t.th,children:"Cantidad"}),e.jsx("th",{style:t.th,children:"Documento"}),e.jsx("th",{style:t.th,children:"Motivo"})]})}),e.jsx("tbody",{children:a.map((o,s)=>{const r=c(o.tipo);return e.jsxs("tr",{style:t.tr,children:[e.jsx("td",{style:t.td,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(j,{size:14,style:{color:"#6c757d"}}),f(o.fecha)]})}),e.jsx("td",{style:t.td,children:e.jsx("strong",{children:o.productos?.nombre||"Producto"})}),e.jsx("td",{style:t.td,children:e.jsxs("span",{style:{...t.badge,background:r.bg,color:r.color},children:[r.icon,o.tipo]})}),e.jsx("td",{style:t.td,children:e.jsxs("span",{style:{fontWeight:"700",color:c(o.tipo).color},children:[o.tipo?.includes("+")||["ENTRADA","DEVOLUCION_VENTA"].includes(o.tipo)?"+":"-",o.cantidad]})}),e.jsx("td",{style:t.td,children:e.jsx("code",{style:t.code,children:o.documento||"-"})}),e.jsx("td",{style:t.td,children:o.motivo||"-"})]},o.id||s)})})]})}),e.jsx("style",{children:"@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }"})]})}const t={container:{padding:"20px",maxWidth:"1200px",margin:"0 auto"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},title:{margin:0,fontSize:"28px",fontWeight:"700",color:"#1a5d1a",display:"flex",alignItems:"center"},subtitle:{margin:"8px 0 0 0",color:"#6c757d",fontSize:"14px"},infoCard:{display:"flex",alignItems:"flex-start",gap:"15px",padding:"20px",background:"#e3f2fd",borderRadius:"12px",marginBottom:"20px",border:"1px solid #90caf9",color:"#1565c0"},tableContainer:{background:"white",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.05)",overflow:"auto"},table:{width:"100%",borderCollapse:"collapse",minWidth:"800px"},th:{padding:"15px 20px",textAlign:"left",background:"#f8f9fa",color:"#1a5d1a",fontWeight:"600",fontSize:"14px",borderBottom:"2px solid #e9ecef"},tr:{borderBottom:"1px solid #e9ecef"},td:{padding:"15px 20px",fontSize:"14px",color:"#495057"},badge:{display:"inline-flex",alignItems:"center",gap:"6px",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600"},code:{background:"#f8f9fa",padding:"4px 8px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px"},loadingState:{display:"flex",flexDirection:"column",alignItems:"center",padding:"60px",color:"#6c757d",gap:"15px"},emptyState:{display:"flex",flexDirection:"column",alignItems:"center",padding:"60px",color:"#6c757d",gap:"15px",textAlign:"center"}};export{w as default};
